<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>tab2xml: XML Generation from Tables • tab2xml</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="tab2xml: XML Generation from Tables">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tab2xml</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/tab2xml.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/josesamos/tab2xml/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>tab2xml: XML Generation from Tables</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/josesamos/tab2xml/blob/main/vignettes/tab2xml.Rmd" class="external-link"><code>vignettes/tab2xml.Rmd</code></a></small>
      <div class="d-none name"><code>tab2xml.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>XML files are commonly used to configure various tools and
applications. While there are dedicated tools for generating XML files
through structured input forms, in many cases, it is beneficial to
organize data in tables linked by primary and foreign keys, especially
when dealing with large datasets or multiple instances of the same
entity.</p>
<p>The <code>tab2xml</code> package provides a solution by enabling the
generation of XML files based on predefined <strong>templates</strong>
and structured tabular data stored in <strong>Excel (.xlsx) or
OpenDocument Spreadsheet (.ods) files</strong>. By leveraging relational
tables, users can efficiently handle and manage large-scale data entry,
ensuring consistency and ease of modification.</p>
<p>This approach simplifies XML creation, making it more accessible and
scalable when working with complex data structures.</p>
<div class="section level3">
<h3 id="content">Content<a class="anchor" aria-label="anchor" href="#content"></a>
</h3>
<p>In addition to this introduction, the document includes:</p>
<ul>
<li><p>An example based on the definition of an XML schema for
<em>Mondrian</em>, following the <a href="https://mondrian.pentaho.com/documentation/schema.php" class="external-link">Mondrian
Documentation</a>.</p></li>
<li><p>A breakdown of each schema element, detailing the corresponding
tables, their relationships, and the XML templates used for data
transformation.</p></li>
<li><p>Validation of relational schema and template
consistency.</p></li>
<li><p>The process of transforming elements to generate the
schema.</p></li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="example-mondrian-schema">Example: Mondrian Schema<a class="anchor" aria-label="anchor" href="#example-mondrian-schema"></a>
</h2>
<p>The starting point for this example is the Mondrian schema, based on
a schema example from the <a href="https://mondrian.pentaho.com/documentation/schema.php" class="external-link">Mondrian
Documentation</a>, shown below.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode xml"><code class="sourceCode xml"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>&lt;<span class="kw">Schema</span>&gt;</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>    &lt;<span class="kw">Cube</span><span class="ot"> name=</span><span class="st">"Sales"</span>&gt;</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>        &lt;<span class="kw">Table</span><span class="ot"> name=</span><span class="st">"sales_fact_1997"</span> /&gt;</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>        &lt;<span class="kw">Dimension</span><span class="ot"> name=</span><span class="st">"Gender"</span><span class="ot"> foreignKey=</span><span class="st">"customer_id"</span>&gt;</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>            &lt;<span class="kw">Hierarchy</span><span class="ot"> name=</span><span class="st">"Gender"</span><span class="ot"> hasAll=</span><span class="st">"true"</span><span class="ot"> allMemberName=</span><span class="st">"All Genders"</span><span class="ot"> primaryKey=</span><span class="st">"customer_id"</span>&gt;</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>                &lt;<span class="kw">Table</span><span class="ot"> name=</span><span class="st">"customer"</span> /&gt;</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>                &lt;<span class="kw">Level</span><span class="ot"> name=</span><span class="st">"Gender"</span><span class="ot"> column=</span><span class="st">"gender"</span><span class="ot"> type=</span><span class="st">"String"</span><span class="ot"> uniqueMembers=</span><span class="st">"true"</span> /&gt;</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>            &lt;/<span class="kw">Hierarchy</span>&gt;</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>        &lt;/<span class="kw">Dimension</span>&gt;</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>        &lt;<span class="kw">Dimension</span><span class="ot"> name=</span><span class="st">"Time"</span><span class="ot"> foreignKey=</span><span class="st">"time_id"</span>&gt;</span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>            &lt;<span class="kw">Hierarchy</span><span class="ot"> name=</span><span class="st">"Time"</span><span class="ot"> hasAll=</span><span class="st">"false"</span><span class="ot">  primaryKey=</span><span class="st">"time_id"</span>&gt;</span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>                &lt;<span class="kw">Table</span><span class="ot"> name=</span><span class="st">"time_by_day"</span> /&gt;</span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>                &lt;<span class="kw">Level</span><span class="ot"> name=</span><span class="st">"Year"</span><span class="ot"> column=</span><span class="st">"the_year"</span><span class="ot"> type=</span><span class="st">"Numeric"</span><span class="ot"> uniqueMembers=</span><span class="st">"true"</span> /&gt;</span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a>                &lt;<span class="kw">Level</span><span class="ot"> name=</span><span class="st">"Quarter"</span><span class="ot"> column=</span><span class="st">"quarter"</span><span class="ot"> type=</span><span class="st">"Numeric"</span><span class="ot"> uniqueMembers=</span><span class="st">"false"</span> /&gt;</span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a>                &lt;<span class="kw">Level</span><span class="ot"> name=</span><span class="st">"Month"</span><span class="ot"> column=</span><span class="st">"month_of_year"</span><span class="ot"> type=</span><span class="st">"Numeric"</span><span class="ot"> uniqueMembers=</span><span class="st">"false"</span> /&gt;</span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a>            &lt;/<span class="kw">Hierarchy</span>&gt;</span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a>        &lt;/<span class="kw">Dimension</span>&gt;</span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a>        &lt;<span class="kw">Measure</span><span class="ot"> name=</span><span class="st">"Unit Sales"</span><span class="ot"> column=</span><span class="st">"unit_sales"</span><span class="ot"> aggregator=</span><span class="st">"sum"</span><span class="ot"> formatString=</span><span class="st">"#,###"</span> /&gt;</span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a>        &lt;<span class="kw">Measure</span><span class="ot"> name=</span><span class="st">"Store Sales"</span><span class="ot"> column=</span><span class="st">"store_sales"</span><span class="ot"> aggregator=</span><span class="st">"sum"</span><span class="ot"> formatString=</span><span class="st">"#,###.##"</span> /&gt;</span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a>        &lt;<span class="kw">Measure</span><span class="ot"> name=</span><span class="st">"Store Cost"</span><span class="ot"> column=</span><span class="st">"store_cost"</span><span class="ot"> aggregator=</span><span class="st">"sum"</span><span class="ot"> formatString=</span><span class="st">"#,###.00"</span> /&gt;</span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a>        &lt;<span class="kw">CalculatedMember</span><span class="ot"> name=</span><span class="st">"Profit"</span><span class="ot"> dimension=</span><span class="st">"Measures"</span><span class="ot"> formula=</span><span class="st">"[Measures].[Store Sales] - [Measures].[Store Cost]"</span>&gt;</span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a>            &lt;<span class="kw">CalculatedMemberProperty</span><span class="ot"> name=</span><span class="st">"FORMAT_STRING"</span><span class="ot"> value=</span><span class="st">"$#,##0.00"</span> /&gt;</span>
<span id="cb1-23"><a href="#cb1-23" tabindex="-1"></a>        &lt;/<span class="kw">CalculatedMember</span>&gt;</span>
<span id="cb1-24"><a href="#cb1-24" tabindex="-1"></a>    &lt;/<span class="kw">Cube</span>&gt;</span>
<span id="cb1-25"><a href="#cb1-25" tabindex="-1"></a>&lt;/<span class="kw">Schema</span>&gt;</span></code></pre></div>
<p>To define this schema, we can either edit the XML file directly or
use the <em>Pentaho Schema Workbench</em> tool. Another approach is to
break it down into tables and templates, work with the tables, and
generate the required versions directly, as shown below.</p>
</div>
<div class="section level2">
<h2 id="scheme-decomposition">Scheme decomposition<a class="anchor" aria-label="anchor" href="#scheme-decomposition"></a>
</h2>
<p>Next, we will decompose the content of this schema into tables,
defined as sheets in the spreadsheets files (.xlsx or .ods) included in
the package, and templates.</p>
<div class="section level3">
<h3 id="root-of-the-schema-template-schema_template-xml">Root of the schema template: <code>schema_template.xml</code><a class="anchor" aria-label="anchor" href="#root-of-the-schema-template-schema_template-xml"></a>
</h3>
<p>Below is the root of the schema template.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode xml"><code class="sourceCode xml"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>&lt;<span class="kw">Schema</span>&gt;</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>    {Cube}</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>&lt;/<span class="kw">Schema</span>&gt;</span></code></pre></div>
<p><strong>The root can contain only one token</strong> (in this case,
the <code>{Cube}</code> token). If multiple tokens or none are found, an
error is raised.</p>
<ul>
<li><p>Tokens are defined using a name enclosed in <code>{</code> and
<code>}</code>.</p></li>
<li><p>Token names are case-insensitive.</p></li>
<li><p><strong>Tokens reference either sheets in the spreadsheet or
columns in the sheet associated with each element</strong>.</p></li>
</ul>
<p>In the example, a schema consists of one or more cubes.</p>
<p>Starting from the root, each element must have an associated
<strong>sheet</strong> and a <strong>template</strong> file, where the
sheet’s columns or other components are included.</p>
</div>
<div class="section level3">
<h3 id="cube">Cube<a class="anchor" aria-label="anchor" href="#cube"></a>
</h3>
<p>Only one cube is defined in the schema; therefore, the table contains
only one row.</p>
<ul>
<li><p>If we need to reference this element from another, we add a
<strong>primary key column</strong>. The name of this column
<strong>must consist of the sheet name followed by the <code>_pk</code>
suffix</strong>.</p></li>
<li><p>To reference elements from another table, we add a
<strong>foreign key column</strong>, named <strong>after the referenced
sheet with the <code>_fk</code> suffix</strong>.</p></li>
</ul>
<p>In this case, a cube has an associated table. However, since other
elements can also have associated tables, we add the foreign key to the
cube (as well as to each element with an associated table).</p>
<table class="table">
<thead><tr class="header">
<th align="right">cube_pk</th>
<th align="left">name</th>
<th align="right">table_fk</th>
</tr></thead>
<tbody><tr class="odd">
<td align="right">1</td>
<td align="left">Sales</td>
<td align="right">1</td>
</tr></tbody>
</table>
<p>Regarding the template, we can include two types of tokens:</p>
<ul>
<li>Tokens referencing <strong>table columns</strong>: these will be
replaced with a value.<br>
</li>
<li>Tokens referencing <strong>other elements</strong> (referenced by
the sheet name): these will be replaced with another template.</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode xml"><code class="sourceCode xml"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>    &lt;<span class="kw">Cube</span><span class="ot"> name=</span><span class="st">"{name}"</span>&gt;</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>        {Table}</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>        {Dimension}</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>        {Measure}</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>        {CalculatedMember}</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>    &lt;/<span class="kw">Cube</span>&gt;</span></code></pre></div>
<p><strong>When including tokens that reference other sheets, each token
must be placed on a separate line, as they will be replaced with
templates.</strong></p>
</div>
<div class="section level3">
<h3 id="table">Table<a class="anchor" aria-label="anchor" href="#table"></a>
</h3>
<p>Since the tables are referenced by other elements, we define a
primary key with values to allow referencing (as we did from the
cube).</p>
<table class="table">
<thead><tr class="header">
<th align="right">table_pk</th>
<th align="left">name</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">sales_fact_1997</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">customer</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">time_by_day</td>
</tr>
</tbody>
</table>
<p>The template only needs to include the table name using the specified
syntax.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode xml"><code class="sourceCode xml"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>                &lt;<span class="kw">Table</span><span class="ot"> name=</span><span class="st">"{name}"</span> /&gt;</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="dimension">Dimension<a class="anchor" aria-label="anchor" href="#dimension"></a>
</h3>
<p>Each dimension is included in a cube and can also contain other
elements that reference it.</p>
<table class="table">
<thead><tr class="header">
<th align="right">dimension_pk</th>
<th align="left">name</th>
<th align="left">foreignKey</th>
<th align="right">cube_fk</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">Gender</td>
<td align="left">customer_id</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">Time</td>
<td align="left">time_id</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<p>In the template, the sheet’s columns and the containing element
(which includes one or more hierarchies) are referenced.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode xml"><code class="sourceCode xml"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>        &lt;<span class="kw">Dimension</span><span class="ot"> name=</span><span class="st">"{name}"</span><span class="ot"> foreignKey=</span><span class="st">"{foreignKey}"</span>&gt;</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>            {Hierarchy}</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>        &lt;/<span class="kw">Dimension</span>&gt;</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="hierarchy">Hierarchy<a class="anchor" aria-label="anchor" href="#hierarchy"></a>
</h3>
<p>Hierarchies reference both the dimensions that contain them and their
associated tables.</p>
<table class="table">
<colgroup>
<col width="14%">
<col width="7%">
<col width="7%">
<col width="31%">
<col width="13%">
<col width="14%">
<col width="10%">
</colgroup>
<thead><tr class="header">
<th align="right">hierarchy_pk</th>
<th align="left">name</th>
<th align="left">hasAll</th>
<th align="left">allMemberName</th>
<th align="left">primaryKey</th>
<th align="right">dimension_fk</th>
<th align="right">table_fk</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">Gender</td>
<td align="left">true</td>
<td align="left">allMemberName=“All Genders”</td>
<td align="left">customer_id</td>
<td align="right">1</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">Time</td>
<td align="left">false</td>
<td align="left">NA</td>
<td align="left">time_id</td>
<td align="right">2</td>
<td align="right">3</td>
</tr>
</tbody>
</table>
<p>In the template, we can see that it includes the table and the levels
that make up the hierarchy.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode xml"><code class="sourceCode xml"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>            &lt;<span class="kw">Hierarchy</span><span class="ot"> name=</span><span class="st">"{name}"</span><span class="ot"> hasAll=</span><span class="st">"{hasAll}"</span> <span class="er">{</span><span class="ot">allMemberName</span><span class="er">}</span> <span class="er">primaryKey</span><span class="ot">=</span><span class="st">"{primaryKey}"</span>&gt;</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>                {Table}</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>                {Level}</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>            &lt;/<span class="kw">Hierarchy</span>&gt;</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="level">Level<a class="anchor" aria-label="anchor" href="#level"></a>
</h3>
<p>Levels do not need to be referenced, so they do not include a primary
key. Instead, they reference the hierarchies they belong to.</p>
<table class="table">
<thead><tr class="header">
<th align="left">name</th>
<th align="left">column</th>
<th align="left">type</th>
<th align="left">uniqueMembers</th>
<th align="right">hierarchy_fk</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Gender</td>
<td align="left">gender</td>
<td align="left">String</td>
<td align="left">true</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Year</td>
<td align="left">the_year</td>
<td align="left">Numeric</td>
<td align="left">true</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">Quarter</td>
<td align="left">quarter</td>
<td align="left">Numeric</td>
<td align="left">false</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">Month</td>
<td align="left">month_of_year</td>
<td align="left">Numeric</td>
<td align="left">false</td>
<td align="right">2</td>
</tr>
</tbody>
</table>
<p>The template references the columns of the associated sheet.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode xml"><code class="sourceCode xml"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>                &lt;<span class="kw">Level</span><span class="ot"> name=</span><span class="st">"{name}"</span><span class="ot"> column=</span><span class="st">"{column}"</span><span class="ot"> type=</span><span class="st">"{type}"</span><span class="ot"> uniqueMembers=</span><span class="st">"{uniqueMembers}"</span> /&gt;</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="measure">Measure<a class="anchor" aria-label="anchor" href="#measure"></a>
</h3>
<p>Measures are included in cubes and must reference them. Since they do
not need to be referenced, they do not require a primary key.</p>
<table class="table">
<thead><tr class="header">
<th align="left">name</th>
<th align="left">column</th>
<th align="left">aggregator</th>
<th align="left">formatString</th>
<th align="right">cube_fk</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Unit Sales</td>
<td align="left">unit_sales</td>
<td align="left">sum</td>
<td align="left">#,###</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Store Sales</td>
<td align="left">store_sales</td>
<td align="left">sum</td>
<td align="left">#,###.##</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">Store Cost</td>
<td align="left">store_cost</td>
<td align="left">sum</td>
<td align="left">#,###.00</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<p>The template includes the columns from the sheet.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode xml"><code class="sourceCode xml"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>        &lt;<span class="kw">Measure</span><span class="ot"> name=</span><span class="st">"{name}"</span><span class="ot"> column=</span><span class="st">"{column}"</span><span class="ot"> aggregator=</span><span class="st">"{aggregator}"</span><span class="ot"> formatString=</span><span class="st">"{formatString}"</span> /&gt;</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="calculatedmember">CalculatedMember<a class="anchor" aria-label="anchor" href="#calculatedmember"></a>
</h3>
<p>Calculated members may have components that must be referenceable
(they have a primary key) and are included in cubes.</p>
<table class="table">
<colgroup>
<col width="20%">
<col width="7%">
<col width="10%">
<col width="53%">
<col width="8%">
</colgroup>
<thead><tr class="header">
<th align="right">calculatedmember_pk</th>
<th align="left">name</th>
<th align="left">dimension</th>
<th align="left">formula</th>
<th align="right">cube_fk</th>
</tr></thead>
<tbody><tr class="odd">
<td align="right">1</td>
<td align="left">Profit</td>
<td align="left">Measures</td>
<td align="left">[Measures].[Store Sales] - [Measures].[Store Cost]</td>
<td align="right">1</td>
</tr></tbody>
</table>
<p>The template shows the elements they contain.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode xml"><code class="sourceCode xml"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>        &lt;<span class="kw">CalculatedMember</span><span class="ot"> name=</span><span class="st">"{name}"</span><span class="ot"> dimension=</span><span class="st">"{dimension}"</span><span class="ot"> formula=</span><span class="st">"{formula}"</span>&gt;</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>            {CalculatedMemberProperty}</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>        &lt;/<span class="kw">CalculatedMember</span>&gt;</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="calculatedmemberproperty">CalculatedMemberProperty<a class="anchor" aria-label="anchor" href="#calculatedmemberproperty"></a>
</h3>
<p>Finally, we have the properties of the calculated members they
reference.</p>
<table class="table">
<thead><tr class="header">
<th align="left">name</th>
<th align="left">value</th>
<th align="right">calculatedmember_fk</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">FORMAT_STRING</td>
<td align="left">$#,##0.00</td>
<td align="right">1</td>
</tr></tbody>
</table>
<p>The template uses the columns from the corresponding sheet.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode xml"><code class="sourceCode xml"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>            &lt;<span class="kw">CalculatedMemberProperty</span><span class="ot"> name=</span><span class="st">"{name}"</span><span class="ot"> value=</span><span class="st">"{value}"</span> /&gt;</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>            </span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="validation-of-relational-schema-and-template-consistency">Validation of Relational Schema and Template Consistency<a class="anchor" aria-label="anchor" href="#validation-of-relational-schema-and-template-consistency"></a>
</h2>
<p>The <code><a href="../reference/check_tab.html">check_tab()</a></code> function is designed to validate the
structure and consistency of spreadsheet data against predefined
templates, ensuring data integrity before further processing, such as
XML generation.</p>
<ul>
<li>Reads and extracts sheets from an Excel (<code>.xlsx</code>) or
OpenDocument Spreadsheet (<code>.ods</code>) file.<br>
</li>
<li>Ensures that primary and foreign keys are properly structured across
related tables.<br>
</li>
<li>If a template file is provided, it cross-checks the spreadsheet
against expected column names and relationships.<br>
</li>
<li>It verifies that all required fields exist and warns if any are
missing or incorrectly named.</li>
</ul>
<div class="section level3">
<h3 id="usage-example">Usage Example<a class="anchor" aria-label="anchor" href="#usage-example"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://josesamos.github.io/tab2xml/">tab2xml</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define file paths</span></span>
<span><span class="va">source_xml</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"schema_template.xml"</span>, package <span class="op">=</span> <span class="st">"tab2xml"</span><span class="op">)</span></span>
<span><span class="va">source_xlsx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"schema.xlsx"</span>, package <span class="op">=</span> <span class="st">"tab2xml"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># check files</span></span>
<span><span class="fu"><a href="../reference/check_tab.html">check_tab</a></span><span class="op">(</span><span class="va">source_xlsx</span>, <span class="va">source_xml</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>Reports all possible errors it detects. In this case, there is no
error. When finished it always returns TRUE.</p>
</div>
</div>
<div class="section level2">
<h2 id="generate-the-schema">Generate the Schema<a class="anchor" aria-label="anchor" href="#generate-the-schema"></a>
</h2>
<p>To generate the schema, tokens in each template are replaced with
corresponding values from a data source.</p>
<p>It handles both direct replacements from the associated sheet and
foreign key relationships.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define output file</span></span>
<span><span class="va">temp_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".xml"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Convert spreadsheet to XML</span></span>
<span><span class="va">file</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sheet2xml.html">sheet2xml</a></span><span class="op">(</span><span class="va">source_xlsx</span>, <span class="va">source_xml</span>, <span class="va">temp_file</span><span class="op">)</span></span></code></pre></div>
<p>As shown in the example, we only need to specify:</p>
<ul>
<li><p>The <strong>spreadsheet file</strong>.</p></li>
<li><p>The <strong>root template</strong>. The rest of the templates
must be located in the same folder as the root template and are
determined from the content of the templates being processed.</p></li>
<li><p>The name of the <strong>output XML file</strong> (if none is
specified, a file with the same name as the spreadsheet is created in
the same location).</p></li>
</ul>
<p>The resulting output is shown below.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://xml2.r-lib.org/" class="external-link">xml2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">xml_content</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readLines.html" class="external-link">readLines</a></span><span class="op">(</span><span class="va">file</span>, warn <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"```xml\n"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">xml_content</span>, collapse <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span>, <span class="st">"\n```"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode xml"><code class="sourceCode xml"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>&lt;<span class="kw">Schema</span>&gt;</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>    &lt;<span class="kw">Cube</span><span class="ot"> name=</span><span class="st">"Sales"</span>&gt;</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>                &lt;<span class="kw">Table</span><span class="ot"> name=</span><span class="st">"sales_fact_1997"</span> /&gt;</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>        &lt;<span class="kw">Dimension</span><span class="ot"> name=</span><span class="st">"Gender"</span><span class="ot"> foreignKey=</span><span class="st">"customer_id"</span>&gt;</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>            &lt;<span class="kw">Hierarchy</span><span class="ot"> name=</span><span class="st">"Gender"</span><span class="ot"> hasAll=</span><span class="st">"true"</span><span class="ot"> allMemberName=</span><span class="st">"All Genders"</span><span class="ot"> primaryKey=</span><span class="st">"customer_id"</span>&gt;</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>                &lt;<span class="kw">Table</span><span class="ot"> name=</span><span class="st">"customer"</span> /&gt;</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>                &lt;<span class="kw">Level</span><span class="ot"> name=</span><span class="st">"Gender"</span><span class="ot"> column=</span><span class="st">"gender"</span><span class="ot"> type=</span><span class="st">"String"</span><span class="ot"> uniqueMembers=</span><span class="st">"true"</span> /&gt;</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>            &lt;/<span class="kw">Hierarchy</span>&gt;</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>        &lt;/<span class="kw">Dimension</span>&gt;</span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>        &lt;<span class="kw">Dimension</span><span class="ot"> name=</span><span class="st">"Time"</span><span class="ot"> foreignKey=</span><span class="st">"time_id"</span>&gt;</span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>            &lt;<span class="kw">Hierarchy</span><span class="ot"> name=</span><span class="st">"Time"</span><span class="ot"> hasAll=</span><span class="st">"false"</span><span class="ot">  primaryKey=</span><span class="st">"time_id"</span>&gt;</span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a>                &lt;<span class="kw">Table</span><span class="ot"> name=</span><span class="st">"time_by_day"</span> /&gt;</span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a>                &lt;<span class="kw">Level</span><span class="ot"> name=</span><span class="st">"Year"</span><span class="ot"> column=</span><span class="st">"the_year"</span><span class="ot"> type=</span><span class="st">"Numeric"</span><span class="ot"> uniqueMembers=</span><span class="st">"true"</span> /&gt;</span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a>                &lt;<span class="kw">Level</span><span class="ot"> name=</span><span class="st">"Quarter"</span><span class="ot"> column=</span><span class="st">"quarter"</span><span class="ot"> type=</span><span class="st">"Numeric"</span><span class="ot"> uniqueMembers=</span><span class="st">"false"</span> /&gt;</span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a>                &lt;<span class="kw">Level</span><span class="ot"> name=</span><span class="st">"Month"</span><span class="ot"> column=</span><span class="st">"month_of_year"</span><span class="ot"> type=</span><span class="st">"Numeric"</span><span class="ot"> uniqueMembers=</span><span class="st">"false"</span> /&gt;</span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a>            &lt;/<span class="kw">Hierarchy</span>&gt;</span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a>        &lt;/<span class="kw">Dimension</span>&gt;</span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a>        &lt;<span class="kw">Measure</span><span class="ot"> name=</span><span class="st">"Unit Sales"</span><span class="ot"> column=</span><span class="st">"unit_sales"</span><span class="ot"> aggregator=</span><span class="st">"sum"</span><span class="ot"> formatString=</span><span class="st">"#,###"</span> /&gt;</span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a>        &lt;<span class="kw">Measure</span><span class="ot"> name=</span><span class="st">"Store Sales"</span><span class="ot"> column=</span><span class="st">"store_sales"</span><span class="ot"> aggregator=</span><span class="st">"sum"</span><span class="ot"> formatString=</span><span class="st">"#,###.##"</span> /&gt;</span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a>        &lt;<span class="kw">Measure</span><span class="ot"> name=</span><span class="st">"Store Cost"</span><span class="ot"> column=</span><span class="st">"store_cost"</span><span class="ot"> aggregator=</span><span class="st">"sum"</span><span class="ot"> formatString=</span><span class="st">"#,###.00"</span> /&gt;</span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a>        &lt;<span class="kw">CalculatedMember</span><span class="ot"> name=</span><span class="st">"Profit"</span><span class="ot"> dimension=</span><span class="st">"Measures"</span><span class="ot"> formula=</span><span class="st">"[Measures].[Store Sales] - [Measures].[Store Cost]"</span>&gt;</span>
<span id="cb14-22"><a href="#cb14-22" tabindex="-1"></a>            &lt;<span class="kw">CalculatedMemberProperty</span><span class="ot"> name=</span><span class="st">"FORMAT_STRING"</span><span class="ot"> value=</span><span class="st">"$#,##0.00"</span> /&gt;</span>
<span id="cb14-23"><a href="#cb14-23" tabindex="-1"></a>            </span>
<span id="cb14-24"><a href="#cb14-24" tabindex="-1"></a>        &lt;/<span class="kw">CalculatedMember</span>&gt;</span>
<span id="cb14-25"><a href="#cb14-25" tabindex="-1"></a>    &lt;/<span class="kw">Cube</span>&gt;</span>
<span id="cb14-26"><a href="#cb14-26" tabindex="-1"></a>&lt;/<span class="kw">Schema</span>&gt;</span></code></pre></div>
<div class="section level3">
<h3 id="conclusions">Conclusions<a class="anchor" aria-label="anchor" href="#conclusions"></a>
</h3>
<p>The <code>tab2xml</code> package offers an efficient and scalable
method for generating XML files from tabular data. By using structured
templates and relational tables, the package facilitates the management
of complex datasets while maintaining consistency and accuracy.</p>
<p>This approach is particularly advantageous for scenarios requiring
the generation of large XML files or handling multiple entities with
defined relationships. It streamlines the transformation process,
reduces manual errors, and enhances maintainability by allowing users to
modify the underlying data without altering the XML structure.</p>
<p>The provided example, based on the <em>Mondrian</em> schema,
demonstrates how to apply this methodology to real-world use cases. This
framework can be extended to other domains requiring XML generation from
relational data, offering a flexible and robust solution for data-driven
XML creation.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jose Samos.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
